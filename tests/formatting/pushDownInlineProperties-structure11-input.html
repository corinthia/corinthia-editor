<!DOCTYPE html>
<html>
<head>
<script>
function performTest(api)
{
    api.Selection.preserveWhileExecuting(function() {
        var range = api.Selection.get();
        api.Range.ensureValidHierarchy(range);
        api.Formatting.splitAroundSelection(range);
        var outermost = api.Range.getOutermostNodes(range);
        api.Formatting.pushDownInlineProperties(outermost);
    });
}
</script>
</head>
<body>
<div style="font-weight: bold; font-style: italic; text-decoration: underline">
  <p style="color: red">First [line</p>
  <p style="color: green">Second line</p>
  <p style="color: blue">Third line</p>
</div>
<div style="font-weight: bold; font-style: italic; text-decoration: underline">
  <p style="color: yellow">Fourth line</p>
  <p style="color: fuchsia">Fifth] line</p>
</div>
</body>
</html>
