<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html> <head>
<title></title>
</head>

<style type="text/css">
p { page-break-inside: avoid }
</style>

<script language="javascript">
function save()
{
    var win = window.open();
    var text = win.document.createTextNode(document.documentElement.outerHTML);
    var pre = win.document.createElement("PRE");
    pre.appendChild(text);
    win.document.body.appendChild(pre);
}
</script>

<body>

<p><input type="button" value="Save" onclick="save()"></p>

<!-- sync with export.html and Editor.m -->
<script language="javascript" src="../ElementProxy.js"></script>
<script language="javascript" src="../ElementProxyMap.js"></script>
<script language="javascript" src="elements/DocxAbstractNum.js"></script>
<script language="javascript" src="elements/DocxBorderProperties.js"></script>
<script language="javascript" src="elements/DocxCellProperties.js"></script>
<script language="javascript" src="elements/DocxIndentation.js"></script>
<script language="javascript" src="elements/DocxIndividualBorder.js"></script>
<script language="javascript" src="elements/DocxLevel.js"></script>
<script language="javascript" src="elements/DocxNumbering.js"></script>
<script language="javascript" src="elements/DocxNumPr.js"></script>
<script language="javascript" src="elements/DocxParagraphProperties.js"></script>
<script language="javascript" src="elements/DocxRunProperties.js"></script>
<script language="javascript" src="elements/DocxSectionProperties.js"></script>
<script language="javascript" src="elements/DocxSpacing.js"></script>
<script language="javascript" src="elements/DocxTableGrid.js"></script>
<script language="javascript" src="elements/DocxTableLook.js"></script>
<script language="javascript" src="elements/DocxTableProperties.js"></script>
<script language="javascript" src="elements/DocxTableStyleProperties.js"></script>
<script language="javascript" src="elements/DocxTableWidth.js"></script>
<script language="javascript" src="DocxStyle.js"></script>
<script language="javascript" src="DocxStyleCollection.js"></script>
<script language="javascript" src="DocxUtil.js"></script>
<script language="javascript" src="filesystem.js"></script>
<script language="javascript" src="colors.js"></script>
<script language="javascript" src="htmltable.js"></script>
<script language="javascript" src="DocxDocument.js"></script>
<script language="javascript" src="html2docx.js"></script>

<script language="javascript">
//var filename = "docx/docs/exhaustive.docx";
var filename = "docx/testdocs/table-styles-3.docx";
//var filename = "docx/docs/builtin-table-styles.docx";

//printNumbering(word.numbering);
//printStyles(word.styles);

var doc = new DocxDocument(filename);
doc.toHTML(filename);



function printNumbering(numbering)
{
    for (var i = 0; i < numbering.length; i++) {
        var abstractNum = numbering[i];
        if (abstractNum == null)
            continue;
        for (var level = 0; level < abstractNum.levels.length; level++) {
            var l = abstractNum.levels[level];
            debug("num "+i+" level "+level+
                  " start "+l.start+
                  " numFmt "+l.numFmt+
                  " lvlText "+l.lvlText+
                  " lvlJc "+l.lvlJc);
        }
    }
}

function printStyles(styles)
{
    debug("printStyles");
    for (var styleId in styles) {
        var style = styles[styleId];
        debug("style "+styleId+":");
        style.print("    ");
        debug("");
        var cssProperties = new Object();
        style.applyCSSProperties(cssProperties);
        mergeCSSProperties(cssProperties);

        var names = new Array();
        for (name in cssProperties)
            names.push(name);
        names.sort();
        debug("."+styleId+" {");
        for (var i = 0; i < names.length; i++) {
            var line = "    "+names[i]+": "+cssProperties[names[i]];
            if (i+1 < names.length)
                debug(line+";");
            else
                debug(line);
        }
        debug("}");
        debug("");
    }
}

function debug(str)
{
    console.log(str);
}

function warning(str)
{
    console.log("WARNING: "+str);
}
</script>

</body>
